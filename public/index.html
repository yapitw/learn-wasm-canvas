<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>WebAssembly Demo</title>
  <style media="screen">
    body,
    canvas {
      width: 100%;
      height: 100%;
      margin: 0;
    }
  </style>
</head>

<body>
  <canvas id="canvas" height="2000" width="2000"></canvas>
  <script src="canvas.js"></script>
  <script>
    // Create canvas context
    const canvas = document.getElementById('canvas')
    const context = canvas.getContext('2d')

    // Render circles on canvas

    const render = (dataLength, circleStructSize) => {

      // Get circle data from C - Typed Array
      let circles = new Int32Array(Module.HEAP32.buffer, _getCircles(), dataLength)

      // Loop data and get circle chunks
      for (let i = 0; i < circles.length; i += circleStructSize) {

        // Get circle data chunk
        let circle = circles.slice(i, i + circleStructSize)

        const [x, y, r, cr, cg, cb] = circle
        // Draw circle
        context.beginPath()
        context.arc(x, y, r, 0, 2 * Math.PI, false)
        context.fillStyle = `rgba(${cr}, ${cg}, ${cb}, 1)`
        context.fill()
      }

      console.log('rendered')

      // Request next animation frame and re-render with updated circles
      // window.requestAnimationFrame(render)
    }


  </script>
</body>

</html>